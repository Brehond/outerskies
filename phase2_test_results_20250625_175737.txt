üöÄ Starting Phase 2 Monitoring & Observability Tests
============================================================
‚úÖ HealthCheckResult Creation: PASS
   Details: {'response_time': 0.5}
‚úÖ Database Health Check: PASS
   Details: {'status': 'healthy', 'response_time': 0.0}
‚úÖ Redis Health Check: PASS
   Details: {'status': 'healthy', 'response_time': 0.023633241653442383}
‚úÖ Comprehensive Health Check: PASS
   Details: {'overall_status': 'unhealthy', 'total_checks': 8}
‚úÖ Performance Monitor: PASS
   Details: {'cache_hits': 1, 'cache_misses': 1}
‚úÖ get_system_health Function: PASS
   Details: {'overall_status': 'unhealthy'}
‚úÖ get_quick_health_status Function: PASS
   Details: {'status': 'healthy'}
‚úÖ Performance Functions: PASS
   Details: {'period_minutes': 60}
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Subject: Error 503 on /api/v1/system/health/
From: noreply@outerskies.com
To: admin@example.com
Date: Wed, 25 Jun 2025 20:57:46 -0000
Message-ID: <175088506632.11788.17805391746316455336@DESKTOP-SUFT37C.home>

{
  "status_code": 503,
  "path": "/api/v1/system/health/",
  "method": "GET",
  "client_ip": "127.0.0.1",
  "user_agent": null,
  "timestamp": 1750885066.323799
}
-------------------------------------------------------------------------------
‚úÖ Health API Endpoint: PASS
   Details: {'status_code': 503, 'api_status': 'error'}
‚ùå API Endpoints: FAIL
   Error: Unexpected status: 400, content: b'{"error": "Request signature is required"}'
Traceback (most recent call last):
  File "C:\Users\trueb\outer-skies\test_phase2_monitoring.py", line 250, in test_api_endpoints
    assert response.status_code in [200, 503], f"Unexpected status: {response.status_code}, content: {response.content}"
AssertionError: Unexpected status: 400, content: b'{"error": "Request signature is required"}'

‚ùå Admin Dashboard Access: FAIL
   Error: Expected 403, got 302, content: b''
Traceback (most recent call last):
  File "C:\Users\trueb\outer-skies\test_phase2_monitoring.py", line 275, in test_admin_dashboard_access
    assert response.status_code == 403, f"Expected 403, got {response.status_code}, content: {response.content}"
AssertionError: Expected 403, got 302, content: b''

‚ùå Middleware Integration: FAIL
   Error: Middleware not found in settings: ['django.middleware.security.SecurityMiddleware', 'django.contrib.sessions.middleware.SessionMiddleware', 'django.middleware.common.CommonMiddleware', 'django.middleware.csrf.CsrfViewMiddleware', 'django.contrib.auth.middleware.AuthenticationMiddleware', 'django.contrib.messages.middleware.MessageMiddleware', 'django.middleware.clickjacking.XFrameOptionsMiddleware', 'django_prometheus.middleware.PrometheusBeforeMiddleware', 'django_prometheus.middleware.PrometheusAfterMiddleware', 'chart.middleware.security.EnhancedSecurityMiddleware', 'chart.middleware.rate_limit.RateLimitMiddleware', 'chart.middleware.auth.APIAuthMiddleware', 'chart.middleware.validation.DataValidationMiddleware', 'chart.middleware.password.PasswordSecurityMiddleware', 'chart.middleware.file_upload.FileUploadSecurityMiddleware', 'chart.middleware.error_handling.ErrorHandlingMiddleware', 'chart.middleware.session.SessionSecurityMiddleware', 'chart.middleware.api_version.APIVersionMiddleware', 'chart.middleware.request_signing.RequestSigningMiddleware', 'chart.middleware.encryption.EncryptionMiddleware']
Traceback (most recent call last):
  File "C:\Users\trueb\outer-skies\test_phase2_monitoring.py", line 298, in test_middleware_integration
    assert 'monitoring.performance_monitor.PerformanceMonitoringMiddleware' in middleware_classes, f"Middleware not found in settings: {middleware_classes}"
AssertionError: Middleware not found in settings: ['django.middleware.security.SecurityMiddleware', 'django.contrib.sessions.middleware.SessionMiddleware', 'django.middleware.common.CommonMiddleware', 'django.middleware.csrf.CsrfViewMiddleware', 'django.contrib.auth.middleware.AuthenticationMiddleware', 'django.contrib.messages.middleware.MessageMiddleware', 'django.middleware.clickjacking.XFrameOptionsMiddleware', 'django_prometheus.middleware.PrometheusBeforeMiddleware', 'django_prometheus.middleware.PrometheusAfterMiddleware', 'chart.middleware.security.EnhancedSecurityMiddleware', 'chart.middleware.rate_limit.RateLimitMiddleware', 'chart.middleware.auth.APIAuthMiddleware', 'chart.middleware.validation.DataValidationMiddleware', 'chart.middleware.password.PasswordSecurityMiddleware', 'chart.middleware.file_upload.FileUploadSecurityMiddleware', 'chart.middleware.error_handling.ErrorHandlingMiddleware', 'chart.middleware.session.SessionSecurityMiddleware', 'chart.middleware.api_version.APIVersionMiddleware', 'chart.middleware.request_signing.RequestSigningMiddleware', 'chart.middleware.encryption.EncryptionMiddleware']

‚ùå Logging and Alerting: FAIL
   Error: Expected warning/error in logs. Log output: 
Traceback (most recent call last):
  File "C:\Users\trueb\outer-skies\test_phase2_monitoring.py", line 317, in test_logging_and_alerting
    assert 'warning' in log_output.lower() or 'error' in log_output.lower(), f"Expected warning/error in logs. Log output: {log_output}"
AssertionError: Expected warning/error in logs. Log output: 

‚úÖ Cache Integration: PASS
   Details: {'set_operation': True, 'get_operation': True, 'delete_operation': True}
‚úÖ Database Integration: PASS
   Details: {'query_executed': True, 'result_count': 55}
‚úÖ Error Handling - Invalid Metric Value: PASS

============================================================
üìä PHASE 2 TEST RESULTS SUMMARY
============================================================
Total Tests: 16
Passed: 12 ‚úÖ
Failed: 4 ‚ùå
Success Rate: 75.0%
Test Duration: 11.16 seconds

‚ùå FAILED TESTS:
  - API Endpoints: Unexpected status: 400, content: b'{"error": "Request signature is required"}'
  - Admin Dashboard Access: Expected 403, got 302, content: b''
  - Middleware Integration: Middleware not found in settings: ['django.middleware.security.SecurityMiddleware', 'django.contrib.sessions.middleware.SessionMiddleware', 'django.middleware.common.CommonMiddleware', 'django.middleware.csrf.CsrfViewMiddleware', 'django.contrib.auth.middleware.AuthenticationMiddleware', 'django.contrib.messages.middleware.MessageMiddleware', 'django.middleware.clickjacking.XFrameOptionsMiddleware', 'django_prometheus.middleware.PrometheusBeforeMiddleware', 'django_prometheus.middleware.PrometheusAfterMiddleware', 'chart.middleware.security.EnhancedSecurityMiddleware', 'chart.middleware.rate_limit.RateLimitMiddleware', 'chart.middleware.auth.APIAuthMiddleware', 'chart.middleware.validation.DataValidationMiddleware', 'chart.middleware.password.PasswordSecurityMiddleware', 'chart.middleware.file_upload.FileUploadSecurityMiddleware', 'chart.middleware.error_handling.ErrorHandlingMiddleware', 'chart.middleware.session.SessionSecurityMiddleware', 'chart.middleware.api_version.APIVersionMiddleware', 'chart.middleware.request_signing.RequestSigningMiddleware', 'chart.middleware.encryption.EncryptionMiddleware']
  - Logging and Alerting: Expected warning/error in logs. Log output: 

============================================================
DETAILED TEST RESULTS
============================================================

Test: HealthCheckResult Creation
Status: PASS
Timestamp: 2025-06-25T20:57:37.962939+00:00
Details: {
  "response_time": 0.5
}
----------------------------------------

Test: Database Health Check
Status: PASS
Timestamp: 2025-06-25T20:57:37.962939+00:00
Details: {
  "status": "healthy",
  "response_time": 0.0
}
----------------------------------------

Test: Redis Health Check
Status: PASS
Timestamp: 2025-06-25T20:57:37.987569+00:00
Details: {
  "status": "healthy",
  "response_time": 0.023633241653442383
}
----------------------------------------

Test: Comprehensive Health Check
Status: PASS
Timestamp: 2025-06-25T20:57:40.523762+00:00
Details: {
  "overall_status": "unhealthy",
  "total_checks": 8
}
----------------------------------------

Test: Performance Monitor
Status: PASS
Timestamp: 2025-06-25T20:57:40.524526+00:00
Details: {
  "cache_hits": 1,
  "cache_misses": 1
}
----------------------------------------

Test: get_system_health Function
Status: PASS
Timestamp: 2025-06-25T20:57:43.283133+00:00
Details: {
  "overall_status": "unhealthy"
}
----------------------------------------

Test: get_quick_health_status Function
Status: PASS
Timestamp: 2025-06-25T20:57:43.283133+00:00
Details: {
  "status": "healthy"
}
----------------------------------------

Test: Performance Functions
Status: PASS
Timestamp: 2025-06-25T20:57:43.284151+00:00
Details: {
  "period_minutes": 60
}
----------------------------------------

Test: Health API Endpoint
Status: PASS
Timestamp: 2025-06-25T20:57:46.347418+00:00
Details: {
  "status_code": 503,
  "api_status": "error"
}
----------------------------------------

Test: API Endpoints
Status: FAIL
Timestamp: 2025-06-25T20:57:46.350413+00:00
Error: Unexpected status: 400, content: b'{"error": "Request signature is required"}'
----------------------------------------

Test: Admin Dashboard Access
Status: FAIL
Timestamp: 2025-06-25T20:57:46.421984+00:00
Error: Expected 403, got 302, content: b''
----------------------------------------

Test: Middleware Integration
Status: FAIL
Timestamp: 2025-06-25T20:57:46.456167+00:00
Error: Middleware not found in settings: ['django.middleware.security.SecurityMiddleware', 'django.contrib.sessions.middleware.SessionMiddleware', 'django.middleware.common.CommonMiddleware', 'django.middleware.csrf.CsrfViewMiddleware', 'django.contrib.auth.middleware.AuthenticationMiddleware', 'django.contrib.messages.middleware.MessageMiddleware', 'django.middleware.clickjacking.XFrameOptionsMiddleware', 'django_prometheus.middleware.PrometheusBeforeMiddleware', 'django_prometheus.middleware.PrometheusAfterMiddleware', 'chart.middleware.security.EnhancedSecurityMiddleware', 'chart.middleware.rate_limit.RateLimitMiddleware', 'chart.middleware.auth.APIAuthMiddleware', 'chart.middleware.validation.DataValidationMiddleware', 'chart.middleware.password.PasswordSecurityMiddleware', 'chart.middleware.file_upload.FileUploadSecurityMiddleware', 'chart.middleware.error_handling.ErrorHandlingMiddleware', 'chart.middleware.session.SessionSecurityMiddleware', 'chart.middleware.api_version.APIVersionMiddleware', 'chart.middleware.request_signing.RequestSigningMiddleware', 'chart.middleware.encryption.EncryptionMiddleware']
----------------------------------------

Test: Logging and Alerting
Status: FAIL
Timestamp: 2025-06-25T20:57:49.115904+00:00
Error: Expected warning/error in logs. Log output: 
----------------------------------------

Test: Cache Integration
Status: PASS
Timestamp: 2025-06-25T20:57:49.117854+00:00
Details: {
  "set_operation": true,
  "get_operation": true,
  "delete_operation": true
}
----------------------------------------

Test: Database Integration
Status: PASS
Timestamp: 2025-06-25T20:57:49.118851+00:00
Details: {
  "query_executed": true,
  "result_count": 55
}
----------------------------------------

Test: Error Handling - Invalid Metric Value
Status: PASS
Timestamp: 2025-06-25T20:57:49.118851+00:00
----------------------------------------

SUMMARY:
Total Tests: 16
Passed: 12
Failed: 4
Success Rate: 75.0%
Duration: 11.16 seconds
