2025-06-25 16:31:58,214 - __main__ - INFO - === COMPREHENSIVE CELERY TESTING ===
2025-06-25 16:31:58,215 - __main__ - INFO - Test output will be saved to: celery_test_output_20250625_163158.txt
2025-06-25 16:31:58,215 - __main__ - INFO - === TESTING CELERY AVAILABILITY ===
2025-06-25 16:32:04,323 - chart.celery_utils - WARNING - Celery broker not available: [WinError 10061] No connection could be made because the target machine actively refused it
2025-06-25 16:32:04,327 - __main__ - INFO - Celery available: False
2025-06-25 16:32:04,329 - __main__ - INFO - === TESTING SIMPLE TASK ===
2025-06-25 16:32:04,331 - __main__ - INFO - Test parameters: {'utc_date': '1990-01-01', 'utc_time': '16:00', 'latitude': 45.5, 'longitude': -64.3, 'zodiac_type': 'tropical', 'house_system': 'placidus'}
2025-06-25 16:32:04,333 - __main__ - INFO - Calling create_task_with_fallback...
2025-06-25 16:32:04,334 - chart.celery_utils - INFO - === create_task_with_fallback START for ephemeris_test ===
2025-06-25 16:32:04,354 - chart.celery_utils - INFO - task_func: <@task: chart.tasks.calculate_ephemeris_task of default at 0x269d6335790>
2025-06-25 16:32:04,356 - chart.celery_utils - INFO - args: [{'utc_date': '1990-01-01', 'utc_time': '16:00', 'latitude': 45.5, 'longitude': -64.3, 'zodiac_type': 'tropical', 'house_system': 'placidus'}]
2025-06-25 16:32:04,357 - chart.celery_utils - INFO - kwargs: None
2025-06-25 16:32:04,358 - chart.celery_utils - INFO - user: None
2025-06-25 16:32:04,359 - chart.celery_utils - INFO - parameters: {'utc_date': '1990-01-01', 'utc_time': '16:00', 'latitude': 45.5, 'longitude': -64.3, 'zodiac_type': 'tropical', 'house_system': 'placidus'}
2025-06-25 16:32:04,360 - chart.celery_utils - INFO - Generated task_id: 0c07fffe-b02c-46aa-8a05-86ac0bb7fc0a
2025-06-25 16:32:04,361 - chart.celery_utils - INFO - Checking if Celery is available for ephemeris_test...
2025-06-25 16:32:10,468 - chart.celery_utils - WARNING - Celery broker not available: [WinError 10061] No connection could be made because the target machine actively refused it
2025-06-25 16:32:10,471 - chart.celery_utils - WARNING - Celery is not available for ephemeris_test
2025-06-25 16:32:10,473 - chart.celery_utils - ERROR - create_task_with_fallback reached unexpected end for ephemeris_test task
2025-06-25 16:32:10,473 - chart.celery_utils - ERROR - This should never happen - all code paths should return a result
2025-06-25 16:32:10,474 - __main__ - INFO - Task result: {'success': False, 'error': 'Unknown error: no result returned from task creation', 'status': 'FAILURE', 'message': 'No result returned from task creation', 'celery_available': False, 'task_id': '0c07fffe-b02c-46aa-8a05-86ac0bb7fc0a', 'task_status_id': None}
2025-06-25 16:32:10,491 - __main__ - INFO - === TESTING CHART GENERATION ===
2025-06-25 16:32:10,491 - __main__ - INFO - Chart generation parameters: {'utc_date': '1990-01-01', 'utc_time': '16:00', 'latitude': 45.5, 'longitude': -64.3, 'zodiac_type': 'tropical', 'house_system': 'placidus', 'model_name': 'gpt-4', 'temperature': 0.7, 'max_tokens': 1000, 'location': 'Test Location'}
2025-06-25 16:32:10,491 - chart.celery_utils - INFO - === create_task_with_fallback START for chart_generation_test ===
2025-06-25 16:32:10,492 - chart.celery_utils - INFO - task_func: <@task: chart.tasks.generate_chart_task of default at 0x269d6335790>
2025-06-25 16:32:10,492 - chart.celery_utils - INFO - args: [{'utc_date': '1990-01-01', 'utc_time': '16:00', 'latitude': 45.5, 'longitude': -64.3, 'zodiac_type': 'tropical', 'house_system': 'placidus', 'model_name': 'gpt-4', 'temperature': 0.7, 'max_tokens': 1000, 'location': 'Test Location'}]
2025-06-25 16:32:10,493 - chart.celery_utils - INFO - kwargs: None
2025-06-25 16:32:10,494 - chart.celery_utils - INFO - user: None
2025-06-25 16:32:10,494 - chart.celery_utils - INFO - parameters: {'utc_date': '1990-01-01', 'utc_time': '16:00', 'latitude': 45.5, 'longitude': -64.3, 'zodiac_type': 'tropical', 'house_system': 'placidus', 'model_name': 'gpt-4', 'temperature': 0.7, 'max_tokens': 1000, 'location': 'Test Location'}
2025-06-25 16:32:10,495 - chart.celery_utils - INFO - Generated task_id: 191cab19-94fe-42e3-8a0e-d3b86ebeb10a
2025-06-25 16:32:10,497 - chart.celery_utils - INFO - Checking if Celery is available for chart_generation_test...
2025-06-25 16:32:16,605 - chart.celery_utils - WARNING - Celery broker not available: [WinError 10061] No connection could be made because the target machine actively refused it
2025-06-25 16:32:16,606 - chart.celery_utils - WARNING - Celery is not available for chart_generation_test
2025-06-25 16:32:16,607 - chart.celery_utils - ERROR - create_task_with_fallback reached unexpected end for chart_generation_test task
2025-06-25 16:32:16,608 - chart.celery_utils - ERROR - This should never happen - all code paths should return a result
2025-06-25 16:32:16,609 - __main__ - INFO - Chart generation result: {'success': False, 'error': 'Unknown error: no result returned from task creation', 'status': 'FAILURE', 'message': 'No result returned from task creation', 'celery_available': False, 'task_id': '191cab19-94fe-42e3-8a0e-d3b86ebeb10a', 'task_status_id': None}
2025-06-25 16:32:16,612 - __main__ - INFO - === TESTING INTERPRETATION GENERATION ===
2025-06-25 16:32:16,612 - __main__ - INFO - Interpretation parameters: {'model_name': 'gpt-4', 'temperature': 0.7, 'max_tokens': 1000, 'interpretation_type': 'comprehensive'}
2025-06-25 16:32:16,613 - chart.celery_utils - INFO - === create_task_with_fallback START for interpretation_test ===
2025-06-25 16:32:16,613 - chart.celery_utils - INFO - task_func: <@task: chart.tasks.generate_interpretation_task of default at 0x269d6335790>
2025-06-25 16:32:16,614 - chart.celery_utils - INFO - args: [{'julian_day': 2447893.1666666665, 'positions': {'Sun': {'sign': 'Capricorn', 'degree': 10.5}, 'Moon': {'sign': 'Aries', 'degree': 15.2}}, 'ascendant': {'sign': 'Aries', 'degree': 13.1}, 'houses': [0, 30, 60, 90, 120, 150, 180, 210, 240, 270, 300, 330], 'house_signs': ['Aries', 'Taurus', 'Gemini', 'Cancer', 'Leo', 'Virgo', 'Libra', 'Scorpio', 'Sagittarius', 'Capricorn', 'Aquarius', 'Pisces']}, {'model_name': 'gpt-4', 'temperature': 0.7, 'max_tokens': 1000, 'interpretation_type': 'comprehensive'}]
2025-06-25 16:32:16,615 - chart.celery_utils - INFO - kwargs: None
2025-06-25 16:32:16,615 - chart.celery_utils - INFO - user: None
2025-06-25 16:32:16,615 - chart.celery_utils - INFO - parameters: {'model_name': 'gpt-4', 'temperature': 0.7, 'max_tokens': 1000, 'interpretation_type': 'comprehensive'}
2025-06-25 16:32:16,616 - chart.celery_utils - INFO - Generated task_id: a82041b5-beda-4f85-a678-e29f0fe62c37
2025-06-25 16:32:16,617 - chart.celery_utils - INFO - Checking if Celery is available for interpretation_test...
2025-06-25 16:32:22,721 - chart.celery_utils - WARNING - Celery broker not available: [WinError 10061] No connection could be made because the target machine actively refused it
2025-06-25 16:32:22,722 - chart.celery_utils - WARNING - Celery is not available for interpretation_test
2025-06-25 16:32:22,724 - chart.celery_utils - ERROR - create_task_with_fallback reached unexpected end for interpretation_test task
2025-06-25 16:32:22,725 - chart.celery_utils - ERROR - This should never happen - all code paths should return a result
2025-06-25 16:32:22,728 - __main__ - INFO - Interpretation result: {'success': False, 'error': 'Unknown error: no result returned from task creation', 'status': 'FAILURE', 'message': 'No result returned from task creation', 'celery_available': False, 'task_id': 'a82041b5-beda-4f85-a678-e29f0fe62c37', 'task_status_id': None}
2025-06-25 16:32:22,735 - __main__ - INFO - === TESTING DIRECT TASK EXECUTION ===
2025-06-25 16:32:22,736 - __main__ - INFO - Testing direct task execution...
2025-06-25 16:32:22,742 - chart.tasks - INFO - Starting ephemeris calculation task b3c4d92a-f09d-4b6f-8978-a1e5736260e5
2025-06-25 16:32:22,783 - chart.tasks - INFO - Completed ephemeris calculation task b3c4d92a-f09d-4b6f-8978-a1e5736260e5
2025-06-25 16:32:22,785 - celery.app.trace - INFO - Task chart.tasks.calculate_ephemeris_task[b3c4d92a-f09d-4b6f-8978-a1e5736260e5] succeeded in 0.03099999999994907s: {'success': True, 'julian_day': 2447893.1666666665, 'positions': {'Sun': {'absolute_degree': 280.9841671564369, 'sign': 'Capricorn', 'degree': 10.98416715643691, 'retrograde': False, 'house': 1, 'aspects': [...], 'dignity': 'Neutral'}, 'Moon': {'absolute_degree': 335.51547225365795, 'sign': 'Pisces', 'degree': 5.515472253657947, 'retrograde': False, 'house': 1, 'aspects': [...], 'dignity': 'Neutral'}, 'Mercury': {'absolute_degree': 295.6209564847932, 'sign': 'Capricorn', 'degree': 25.620956484793226, 'retrograde': True, 'house': 1, 'aspects': [...], 'dignity': 'Neutral'}, 'Venus': {'absolute_degree': 306.19953435684306, 'sign': 'Aquarius', 'degree': 6.19953435684306, 'retrograde': True, 'house': 1, 'aspects': [...], 'dignity': 'Neutral'}, 'Mars': {'absolute_degree': 250.1173870808668, 'sign': 'Sagittarius', 'degree': 10.117387080866791, 'retrograde': False, 'house': 1, 'aspects': [...], 'dignity': 'Neutral'}, 'Jupiter': {'absolute_degree': 95.12631976638156, 'sign': 'Cancer', 'degree': 5.126319766381556, 'retr...', ...}}}
2025-06-25 16:32:22,787 - __main__ - INFO - Direct task result: b3c4d92a-f09d-4b6f-8978-a1e5736260e5
2025-06-25 16:32:22,787 - __main__ - INFO - Task successful: True
2025-06-25 16:32:22,789 - __main__ - INFO - Task result: {'success': True, 'julian_day': 2447893.1666666665, 'positions': {'Sun': {'absolute_degree': 280.9841671564369, 'sign': 'Capricorn', 'degree': 10.98416715643691, 'retrograde': False, 'house': 1, 'aspects': [{'planet': 'Moon', 'type': 'Sextile', 'orb': 5.468694902778964}, {'planet': 'Jupiter', 'type': 'Opposition', 'orb': 5.857847390055355}, {'planet': 'Saturn', 'type': 'Conjunction', 'orb': 4.693068114191988}, {'planet': 'Uranus', 'type': 'Conjunction', 'orb': 5.188691673121355}, {'planet': 'Neptune', 'type': 'Conjunction', 'orb': 1.0602706072894534}], 'dignity': 'Neutral'}, 'Moon': {'absolute_degree': 335.51547225365795, 'sign': 'Pisces', 'degree': 5.515472253657947, 'retrograde': False, 'house': 1, 'aspects': [{'planet': 'Sun', 'type': 'Sextile', 'orb': 5.468694902778964}, {'planet': 'Mars', 'type': 'Square', 'orb': 4.601914827208844}, {'planet': 'Jupiter', 'type': 'Trine', 'orb': 0.38915248727639096}, {'planet': 'Uranus', 'type': 'Sextile', 'orb': 0.28000322965760915}], 'dignity': 'Neutral'}, 'Mercury': {'absolute_degree': 295.6209564847932, 'sign': 'Capricorn', 'degree': 25.620956484793226, 'retrograde': True, 'house': 1, 'aspects': [{'planet': 'Saturn', 'type': 'Conjunction', 'orb': 9.943721214164327}], 'dignity': 'Neutral'}, 'Venus': {'absolute_degree': 306.19953435684306, 'sign': 'Aquarius', 'degree': 6.19953435684306, 'retrograde': True, 'house': 1, 'aspects': [{'planet': 'Mars', 'type': 'Sextile', 'orb': 3.9178527240237315}, {'planet': 'Jupiter', 'type': 'Quincunx', 'orb': 1.0732145904615038}], 'dignity': 'Neutral'}, 'Mars': {'absolute_degree': 250.1173870808668, 'sign': 'Sagittarius', 'degree': 10.117387080866791, 'retrograde': False, 'house': 1, 'aspects': [{'planet': 'Moon', 'type': 'Square', 'orb': 4.601914827208844}, {'planet': 'Venus', 'type': 'Sextile', 'orb': 3.9178527240237315}], 'dignity': 'Neutral'}, 'Jupiter': {'absolute_degree': 95.12631976638156, 'sign': 'Cancer', 'degree': 5.126319766381556, 'retrograde': True, 'house': 1, 'aspects': [{'planet': 'Sun', 'type': 'Opposition', 'orb': 5.857847390055355}, {'planet': 'Moon', 'type': 'Trine', 'orb': 0.38915248727639096}, {'planet': 'Venus', 'type': 'Quincunx', 'orb': 1.0732145904615038}, {'planet': 'Uranus', 'type': 'Opposition', 'orb': 0.6691557169340001}, {'planet': 'Neptune', 'type': 'Opposition', 'orb': 6.918117997344808}], 'dignity': 'Exaltation'}, 'Saturn': {'absolute_degree': 285.6772352706289, 'sign': 'Capricorn', 'degree': 15.677235270628898, 'retrograde': False, 'house': 1, 'aspects': [{'planet': 'Sun', 'type': 'Conjunction', 'orb': 4.693068114191988}, {'planet': 'Mercury', 'type': 'Conjunction', 'orb': 9.943721214164327}, {'planet': 'Uranus', 'type': 'Conjunction', 'orb': 9.881759787313342}, {'planet': 'Neptune', 'type': 'Conjunction', 'orb': 3.6327975069025342}, {'planet': 'Pluto', 'type': 'Sextile', 'orb': 1.4204782768466941}], 'dignity': 'Ruler'}, 'Uranus': {'absolute_degree': 275.79547548331556, 'sign': 'Capricorn', 'degree': 5.795475483315556, 'retrograde': False, 'house': 1, 'aspects': [{'planet': 'Sun', 'type': 'Conjunction', 'orb': 5.188691673121355}, {'planet': 'Moon', 'type': 'Sextile', 'orb': 0.28000322965760915}, {'planet': 'Jupiter', 'type': 'Opposition', 'orb': 0.6691557169340001}, {'planet': 'Saturn', 'type': 'Conjunction', 'orb': 9.881759787313342}, {'planet': 'Neptune', 'type': 'Conjunction', 'orb': 6.248962280410808}], 'dignity': 'Neutral'}, 'Neptune': {'absolute_degree': 282.04443776372636, 'sign': 'Capricorn', 'degree': 12.044437763726364, 'retrograde': False, 'house': 1, 'aspects': [{'planet': 'Sun', 'type': 'Conjunction', 'orb': 1.0602706072894534}, {'planet': 'Jupiter', 'type': 'Opposition', 'orb': 6.918117997344808}, {'planet': 'Saturn', 'type': 'Conjunction', 'orb': 3.6327975069025342}, {'planet': 'Uranus', 'type': 'Conjunction', 'orb': 6.248962280410808}, {'planet': 'Pluto', 'type': 'Sextile', 'orb': 5.053275783749228}], 'dignity': 'Fall'}, 'Pluto': {'absolute_degree': 227.0977135474756, 'sign': 'Scorpio', 'degree': 17.097713547475593, 'retrograde': False, 'house': 1, 'aspects': [{'planet': 'Saturn', 'type': 'Sextile', 'orb': 1.4204782768466941}, {'planet': 'Neptune', 'type': 'Sextile', 'orb': 5.053275783749228}], 'dignity': 'Ruler'}}, 'ascendant': {'absolute_degree': 13.058492568248969, 'sign': 'Aries', 'degree_in_sign': 13.058492568248969}, 'houses': (13.058492568248969, 52.30441855828194, 76.3367205586783, 96.19163345643585, 117.13842089049075, 145.36440540396342, 193.05849256824897, 232.30441855828195, 256.3367205586783, 276.19163345643585, 297.13842089049075, 325.3644054039634), 'house_signs': {0: 'Aries', 1: 'Taurus', 2: 'Gemini', 3: 'Cancer', 4: 'Cancer', 5: 'Leo', 6: 'Libra', 7: 'Scorpio', 8: 'Sagittarius', 9: 'Capricorn', 10: 'Capricorn', 11: 'Aquarius'}, 'task_id': 'b3c4d92a-f09d-4b6f-8978-a1e5736260e5', 'completed_at': '2025-06-25T19:32:22.760455+00:00'}
2025-06-25 16:32:22,792 - __main__ - INFO - === TEST SUMMARY ===
2025-06-25 16:32:22,802 - __main__ - INFO - Overall: 1/5 tests passed
2025-06-25 16:32:22,802 - __main__ - INFO - Detailed logs saved to: celery_test_output_20250625_163158.txt
